---
layout: post
title: "RegExp"
date: 2017-04-17
tag: JavaScript
---

#### ## RegExp 对象

正则表达式是用于匹配字符串中字符组合的模式。在 JavaScript中，正则表达式也是对象。这些模式被用于 RegExp 的 exec 和 test 方法, 以及 String 的 match、replace、search 和 split 方法。

JavaScript通过内置对象 RegExp 支持正则表达式

两种方式实例化 RegExp 对象

a. 字面量 `var expression = /pattern/ flags;`

	var reg1 = /\bis\b/;
	var reg2 = /\bis\b/g;
	var reg3 = /\bis\b/gi;
	'This is is Is a dog'.replace(reg1, 'X'); // "This X is Is a dog"
	'This is is Is a dog'.replace(reg2, 'X'); // "This X X Is a dog"
	'This is is Is a dog'.replace(reg3, 'X'); // "This X X X a dog"

上面例子可以看出：

* g: global 全文搜索，若不添加，则搜索到第一个匹配停止
* i: ignore case 忽略大小写(默认为大小写敏感)
* m: multiple

b. 构造函数

	var reg4 = new RegExp('\\bis\\b', 'g');
	'This is is Is a dog'.replace(reg4, '2'); // "This 2 2 Is a dog"

#### ## 元字符

元字符：在正则表达式中有特殊含义的非字母字符

> 元字符含义并非唯一，不同场景，可能会有不同含义
> eg : ^ 可以表示..开始，也可表示取反 ( [ ] 中)

| 字符 |                           |预定义类|                |                                  |量词 |       |
|------|-------------------------- |--------|----------------|----------------------------------|-----|-------|
|  \t  | 水平制表符 tab            |.       | [^\r\n]        |任意字符(除回车换行) any character|?    |{0,1}  |
|  \v  | 垂直制表符                |\d      | [0-9]          |digit                             |+    |{1,}   |
|  \n  | 换行符                    |\D      | [^0-9]         |non-digit                         |*    |任意次 |
|  \r  | 回车符                    |\w      | [a-zA-Z_0-9]   |word 字母/数字/下划线             |{n}  |n      |
|  \0  | 空字符                    |\W      | [^a-zA-Z_0-9]  |non-word                          |{n,m}|n~m    |
|  \f  | 换页符                    |\s      | [\t\n\x0B\f\r] |空白符(white space)               |{n,} |>=n    |
|  \cX | 与X对应的控制字符(ctrl+X) |\S      | [^\t\n\x0B\f\r]|non-white space                   |     |       |

量词
![](/images/post/RegExp1.jpg)

| 边界   |                            |
|--------|----------------------------|
|^       |以xxx开始 Start of line     |
|$       |以xxx结束 End of line       |
|\b      |单词边界 word boundary      |
|\B      |非单词边界 non-word boundary|

	边界
	  'This is is a dog'.replace(/is/g, '0'); // "Th0 0 0 a dog"
	  'This is is a dog'.replace(/\bis\b/g, '0'); // "This 0 0 a dog"
	  'This is is a dog'.replace(/\Bis\b/g, '0'); // "Th0 is is a dog"

	  '@abc@123@'.replace(/@./g, 'Q'); // "QbcQ23@"
	  '@abc@123@'.replace(/^@./g, 'Q'); // "Qbc@123@"
	  '@abc@123@'.replace(/.@$/g, 'Q'); // "@abc@12Q"

|范围      |                           |分组|                |
|----------|---------------------------|----|----------------|
|[ ]       |类：用 - 来指定一个字符范围|( ) |使量词作用于分组|
|[ ]中的 ^ |反向类/负向类              |    |                |

	范围 []
	  'a1b2c3d4'.replace(/[abc]/g, 'Q'); // "Q1Q2Q3d4"
	  'a1b2c3d4'.replace(/[^abc]/g, 'Q'); // "aQbQcQQQ"
	  '20-12-20'.replace(/[0-9]/g, 'X'); // "XX-XX-XX"
	  '20-12-20'.replace(/[0-9-]/g, 'X'); // "XXXXXXXX"
	  // []中在后面直接加'-'就可以匹配到'-'

	分组 ()
	  'a1b2c3d4'.replace(/[a-z]\d{3}/g, 'A'); // "a1b2c3d4"
	  // 此时3次作用在\d上，是找不到的
	  'a1b2c3d4'.replace(/([a-z]\d){3}/g, 'A'); // "Ad4"
	  'AppleOrange'.replace(/Apple|Orange/g, 'A'); // "AA"
	  'AppleangeAppOrange'.replace(/App(le|Or)ange/g, 'A'); // "AA"
	  // | 表示'或'

	反向引用/分组捕获
	  '2012-12-20'.replace(/\d{4}-\d{2}-\d{2}/g, '$1'); // "$1"
	  '2012-12-20'.replace(/(\d{4})-(\d{2})-(\d{2})/g, '$1'); // "2012"
	  '2012-12-20'.replace(/(\d{4})-(\d{2})-(\d{2})/g, '$2/$3/$1'); // "12/20/2012"

	分组忽略(分组内加 ?: )
	  '2012-12-20'.replace(/(?:\d{4})-(\d{2})-(\d{2})/g, '$1'); // "12"

#### ## 贪婪/非贪婪模式

贪婪模式：在匹配成功的前提下，尽可能多的匹配

非贪婪模式：尽可能少的匹配，即一旦匹配成功不在继续尝试，在量词后加？

	'12345678'.replace(/\d{3,6}/g, 'A'); // "A78"
	'12345678'.replace(/\d{3,6}?/g, 'A'); // "A45678"
	'12345678'.match(/\d{3,6}?/g); // ["123", "456"]
